# College Football Imperial Map

A live "imperial territory" map where ~130 FBS college football teams compete for ~3,100 US counties. Territory transfers follow a simple rule: **winner takes all**.

## Architecture

**File-Based MVP** - No database needed!

```
Frontend (Next.js)          Backend (Python)           Data (JSON)
├── Map rendering           ├── Initial setup          ├── teams.json
├── API routes              ├── Game ingestion         ├── ownership.json
└── Components              └── Territory updates      └── games/*.json
```

## Quick Start

### 1. Initialize Data Files

```bash
cd backend
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
python setup.py
```

This generates:
- `public/data/teams.json` - 20 teams with colors
- `public/data/ownership.json` - 3,221 counties assigned to nearest teams

### 2. Run Frontend

```bash
npm install
npm run dev
```

Visit http://localhost:3000 to see the map!

## Project Structure

```
imperial-map/
├── backend/                 # Python scripts
│   ├── lib/
│   │   ├── territory.py    # Geospatial calculations
│   │   ├── game_engine.py  # Territory transfer logic
│   │   └── db.py           # JSON file utilities
│   └── setup.py            # Initialize data files
│
├── src/                     # Next.js frontend
│   ├── app/
│   │   ├── api/            # JSON-serving routes
│   │   └── page.tsx        # Map page
│   ├── components/
│   │   └── Map.tsx         # MapLibre GL map
│   └── lib/
│       └── mapUtils.ts     # Client-side utilities
│
└── public/
    └── data/
        ├── us-counties.geojson  # 3,221 US counties
        ├── teams.json           # Generated by setup.py
        ├── ownership.json       # Generated by setup.py
        └── games/               # Game data by week
            └── 2024-week-1.json
```

## How It Works

### Initial State
1. Each of 3,221 US counties assigned to nearest team (by stadium location)
2. 20 major FBS teams start with territories

### During Season
1. Python script fetches completed games
2. **Winner takes ALL counties owned by loser**
3. Updates `ownership.json`
4. Commit + push → Vercel auto-deploys
5. Map updates with new territories

### Data Flow

```
Game Result
    ↓
Python: process_game_result()
    ↓
Update ownership.json
    ↓
git commit && git push
    ↓
Vercel Deploy
    ↓
Users see updated map
```

## Development Workflow

```bash
# Make changes to map
npm run dev

# Update ownership after games
cd backend
python ingest_games.py --week 5
git add public/data/ownership.json
git commit -m "Week 5 results"
git push

# Map auto-updates on Vercel
```

## Cost

**$0/month** - No database, no Lambda, just static JSON files served by Vercel's free tier.

## Future Enhancements

- [ ] Add all 130 FBS teams
- [ ] Automated game ingestion (GitHub Actions)
- [ ] Historical playback / time-travel
- [ ] Contiguity-based transfers (instead of "all-of-loser")
- [ ] Team statistics and leaderboards

## Tech Stack

- **Frontend**: Next.js 14, MapLibre GL JS, TypeScript, Tailwind
- **Backend**: Python 3, Shapely (geospatial)
- **Data**: JSON files, GeoJSON
- **Deploy**: Vercel (frontend), local scripts (backend)
