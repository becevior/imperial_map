# Getting Started

Clean baseline setup. Follow these steps to get the map running.

## Current State

✅ **Working:**
- Frontend Next.js app structure
- Map component (MapLibre GL)
- Python backend scripts
- 3,221 counties GeoJSON data

❌ **Missing:**
- `teams.json` (generated by setup)
- `ownership.json` (generated by setup)

## Setup (5 minutes)

### 1. Backend - Generate Data Files

```bash
cd backend
python3 -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install -r requirements.txt
python setup.py
```

**Output:**
```
🚀 Initializing data files...

📋 Step 1: Creating teams.json...
  ✓ Created teams.json with 20 teams

🗺️  Step 2: Processing county data...
📍 Step 3: Assigning initial ownership...
  📊 Processing 3221 counties...
  🎯 Assigning 3221 counties to nearest teams...
  ✓ Created ownership.json

  📊 Territory distribution:
     texas           523 counties
     nebraska        297 counties
     oklahoma        243 counties
     ...
```

This creates:
- `public/data/teams.json` (20 teams)
- `public/data/ownership.json` (3,221 FIPS → team_id mappings)

### 2. (Optional) Pull Game Results

To layer weekly territory changes, fetch completed FBS games from CollegeFootballData. Set `CFBD_API_KEY` in your environment (or `.env`) for higher rate limits.

```bash
python ingest_games.py --season 2025 --season-type both
```

Weekly summaries are stored under `frontend/public/data/games/2025/`.

### 3. (Optional) Apply Territory Transfers

Walk the ingested results and emit per-week ownership snapshots:

```bash
python apply_transfers.py --season 2025
```

Outputs land in `frontend/public/data/ownership/2025/` and updates the frontend index for the map dropdown.

### 4. Frontend - Run Dev Server

```bash
# In project root
npm install
npm run dev
```

Visit **http://localhost:3000**

You should see a map of the US with counties colored by team!

## Project Structure (Clean!)

```
imperial-map/
├── backend/               # Python - data management
│   ├── lib/
│   │   ├── territory.py  # Geospatial calculations
│   │   ├── game_engine.py # Territory transfer logic
│   │   └── db.py         # JSON file utilities
│   └── setup.py          # ⭐ Run this first
│
├── src/                  # Next.js frontend
│   ├── app/
│   │   ├── api/         # Serve JSON files
│   │   │   ├── teams/route.ts
│   │   │   ├── territory/route.ts
│   │   │   └── games/route.ts
│   │   └── page.tsx     # Map page
│   ├── components/
│   │   └── Map.tsx      # MapLibre rendering
│   └── lib/
│       └── mapUtils.ts  # Client utilities
│
└── public/data/
    ├── us-counties.geojson  # ✅ Committed (3.1MB)
    ├── teams.json           # ⚠️  Generated by setup.py
    └── ownership.json       # ⚠️  Generated by setup.py
```

**Only 13 source files!** (was 40+ before cleanup)

## Architecture

```
┌─────────────┐
│   Browser   │
└──────┬──────┘
       │ HTTP GET /
       ▼
┌─────────────┐
│  Next.js    │
│  (Vercel)   │
└──────┬──────┘
       │ Read files
       ▼
┌─────────────────────┐
│  public/data/       │
│  ├── teams.json     │ ◄── Generated by Python
│  └── ownership.json │ ◄── Updated after games
└─────────────────────┘
```

**No database, no serverless functions, just JSON files!**

## What's Next?

### To See the Map Working:
1. Run `backend/setup.py` (generates data files)
2. Run `npm run dev`
3. Open http://localhost:3000

### To Update After Games:
1. Run `python ingest_games.py --season 2025`
2. Run `python apply_transfers.py --season 2025`
3. `git add frontend/public/data && git commit && git push`
4. Vercel auto-deploys the refreshed map

### To Deploy to Production:
```bash
# Connect to Vercel
vercel

# Deploy
vercel --prod
```

That's it! No database setup, no environment variables needed.

## Troubleshooting

**Map doesn't show?**
- Check: Did `backend/setup.py` create `public/data/teams.json`?
- Check: Does `public/data/ownership.json` exist?
- Check browser console for errors

**Python errors?**
```bash
# Make sure virtual environment is activated
source venv/bin/activate

# Reinstall dependencies
pip install -r requirements.txt
```

**Build errors?**
```bash
# Clean install
rm -rf node_modules package-lock.json
npm install
```

## Files You Can Safely Delete

These are just documentation/notes, not needed for the app:
- `AGENTS.md`
- `CLAUDE.md`
- `PROJECT_STATUS.md`
- `design.md`
- `context/`

## Cost

**$0/month** using:
- Vercel Free Tier (frontend hosting)
- GitHub (JSON file storage)
- Local Python scripts (run on your machine)

No AWS, no database, no API costs!
